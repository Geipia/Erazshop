<!doctype html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ErazShop â€“ Boutique en ligne</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />

  <style>
    :root {
      --bg-color: #f4f4f4;
      --text-color: #333;
      --card-bg: #fff;
      --card-shadow: rgba(0, 0, 0, 0.10);
      --title-color: #111;
      --accent: #ff6a00;
      --price-color: #28a745;
      --border: rgba(0,0,0,0.10);
      --img-bg: rgba(0,0,0,0.04);
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg-color: #121212;
        --text-color: #e0e0e0;
        --card-bg: #1e1e1e;
        --card-shadow: rgba(0, 0, 0, 0.45);
        --title-color: #fff;
        --accent: #ffa447;
        --price-color: #50fa7b;
        --border: rgba(255,255,255,0.12);
        --img-bg: rgba(255,255,255,0.06);
      }
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
    }

    .announcement {
      background-color: var(--accent);
      color: white;
      text-align: center;
      padding: 0.7rem 1rem;
      font-weight: bold;
      font-size: 1rem;
    }

    header {
      background-color: var(--card-bg);
      padding: 2rem 1rem 1rem;
      text-align: center;
      box-shadow: 0 1px 6px var(--card-shadow);
      border-bottom: 1px solid var(--border);
    }

    header img.logo {
      height: 60px;
      margin-bottom: 1rem;
    }

    header h1 {
      margin: 0;
      font-size: 2.2rem;
      color: var(--title-color);
    }

    .search-bar {
      text-align: center;
      padding: 1rem 1rem 0.5rem;
    }

    .search-bar input {
      padding: 0.85rem 1.1rem;
      width: 90%;
      max-width: 460px;
      border-radius: 10px;
      border: 1px solid var(--border);
      font-size: 1rem;
      background: var(--card-bg);
      color: var(--text-color);
      outline: none;
      box-shadow: 0 2px 10px var(--card-shadow);
    }

    .search-bar input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 4px rgba(255, 106, 0, 0.20);
    }

    .hint, .sales-note {
      text-align: center;
      font-size: 0.9rem;
      opacity: 0.85;
      padding: 0 1rem 0.2rem;
    }
    .sales-note { padding-bottom: 1.1rem; }

    .products-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 320px));
      justify-content: center;
      gap: 1.6rem;
      padding: 0.8rem 1.2rem 2rem;
    }

    .product-card {
      position: relative;
      background: var(--card-bg);
      border-radius: 14px;
      box-shadow: 0 6px 20px var(--card-shadow);
      padding: 1.2rem;
      text-align: center;
      border: 1px solid var(--border);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }

    .product-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px var(--card-shadow);
    }

    /* âœ… image ENTIÃˆRE (pas coupÃ©e) */
    .product-card img {
      width: 100%;
      height: 220px;
      object-fit: contain;
      background: var(--img-bg);
      border-radius: 12px;
      margin-bottom: 0.9rem;
      padding: 10px;
    }

    .product-card h2 {
      font-size: 1.05rem;
      color: var(--title-color);
      margin: 0.35rem 0 0.25rem;
      line-height: 1.25;
    }

    .price {
      display: flex;
      justify-content: center;
      align-items: baseline;
      gap: 8px;
      margin: 0.4rem 0 0.7rem;
      font-weight: 700;
    }

    .price .current {
      font-size: 1.1rem;
      color: var(--price-color);
    }

    .price .old-price {
      font-size: 0.9rem;
      opacity: 0.7;
      text-decoration: line-through;
    }

    .product-card p.description {
      font-size: 0.95rem;
      color: var(--text-color);
      margin: 0.3rem 0 0.9rem;
      opacity: 0.95;
    }

    .badge-sale {
      position: absolute;
      top: 12px;
      left: 12px;
      background: var(--accent);
      color: #fff;
      font-weight: 700;
      font-size: 0.8rem;
      padding: 6px 10px;
      border-radius: 999px;
      z-index: 2;
    }

    .add-cart {
      margin: 0.2rem 0 0.8rem;
      padding: 10px 12px;
      border-radius: 10px;
      border: none;
      background: var(--accent);
      color: white;
      font-weight: 700;
      cursor: pointer;
      width: 100%;
    }

    .add-cart:active { transform: translateY(1px); }

    .buy-button {
      display: flex;
      justify-content: center;
      margin-top: 0.2rem;
    }

    .empty {
      text-align: center;
      padding: 1.2rem 1rem 2rem;
      opacity: 0.85;
      display: none;
    }

    footer {
      text-align: center;
      padding: 2rem 1rem;
      font-size: 0.85rem;
      color: var(--text-color);
      opacity: 0.9;
    }

    /* =========================
       PANIER (floating)
       ========================= */
    #cart {
      position: fixed;
      bottom: 18px;
      right: 18px;
      width: 310px;
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 16px;
      box-shadow: 0 14px 40px var(--card-shadow);
      padding: 0.9rem;
      z-index: 999;
    }

    #cart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 800;
      margin-bottom: 0.6rem;
      color: var(--title-color);
    }

    #cart-items {
      max-height: 170px;
      overflow-y: auto;
      margin-bottom: 0.6rem;
      padding-right: 4px;
    }

    .cart-item {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 8px;
      align-items: center;
      padding: 6px 0;
      border-bottom: 1px dashed var(--border);
    }

    .cart-item:last-child { border-bottom: none; }

    .cart-item .name {
      font-size: 0.92rem;
      line-height: 1.2;
    }

    .cart-item .right {
      display: flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
    }

    .cart-item button {
      background: none;
      border: none;
      color: #ff3b30;
      cursor: pointer;
      font-size: 1rem;
      padding: 2px 4px;
    }

    .cart-line, .cart-total {
      display: flex;
      justify-content: space-between;
      margin-top: 8px;
      font-size: 0.95rem;
    }

    .cart-total {
      border-top: 1px solid var(--border);
      padding-top: 8px;
      font-size: 1rem;
      color: var(--title-color);
    }

    .cart-note {
      margin-top: 8px;
      font-size: 0.82rem;
      opacity: 0.85;
      line-height: 1.2;
    }

    .cart-actions {
      margin-top: 10px;
      display: flex;
      gap: 10px;
    }

    .cart-actions button {
      flex: 1;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: transparent;
      color: var(--text-color);
      font-weight: 700;
      cursor: pointer;
    }

    .cart-actions button.primary {
      background: var(--accent);
      color: white;
      border: none;
    }

    @media (max-width: 420px) {
      #cart {
        width: calc(100% - 24px);
        right: 12px;
        left: 12px;
      }
    }
  </style>
</head>

<body>

  <div class="announcement">
    ðŸ”¥ SOLDES : -25% minimum sur tout le site â€” prix dÃ©jÃ  rÃ©duits !
  </div>

  <header>
    <img src="logo.png" alt="Logo ErazShop" class="logo">
    <h1>ErazShop</h1>
  </header>

  <div class="search-bar">
    <input type="text" id="searchInput" placeholder="Rechercher un produit... (ex: casque, sport, gourde)">
  </div>

  <div class="hint" id="countHint"></div>
  <div class="sales-note">ðŸ’¡ Prix affichÃ©s = prix soldÃ©s (ancien prix barrÃ©)</div>

  <div class="products-container" id="products">

    <!-- Gourde -->
    <div class="product-card" data-name="gourde airup retro olfaction bouteille capsule" data-price="39.99">
      <div class="badge-sale">-25 % SOLDES</div>
      <img src="images/gourde.jpeg" alt="Gourde AirUp">
      <h2>Gourde Ã  rÃ©tro olfaction de type Â« AirUp Â»</h2>

      <div class="price">
        <span class="old-price">53,32 â‚¬</span>
        <span class="current">39,99 â‚¬</span>
      </div>

      <p class="description">Bouteille dâ€™eau portable avec capsule de saveur alÃ©atoire. Sans sucre, idÃ©ale en extÃ©rieur.</p>

      <button class="add-cart" onclick="addToCart('Gourde AirUp', 39.99)">âž• Ajouter au panier</button>

      <div class="buy-button">
        <stripe-buy-button
          buy-button-id="buy_btn_1Rc4TZCOWsHWoBEG4Qt0KaJB"
          publishable-key="pk_live_51Rb21ICOWsHWoBEGmAY8BEDjuDe7KjsHoTY4hzhve9aiZd0tUaQoaIEG3aoGHHnwjtc8VrEBDJrIZReI0CTVLYqQ00fikEjr67">
        </stripe-buy-button>
      </div>
    </div>

    <!-- Baskets -->
    <div class="product-card" data-name="baskets reactive chaussures sport respirante" data-price="24.90">
      <div class="badge-sale">-25 % SOLDES</div>
      <img src="images/basket.jpg" alt="Baskets REACTIVE">
      <h2>Baskets de sport REACTIVEâ„¢</h2>

      <div class="price">
        <span class="old-price">33,20 â‚¬</span>
        <span class="current">24,90 â‚¬</span>
      </div>

      <p class="description">Design dÃ©gradÃ©, semelle amortissante et maille respirante. Confort moderne au quotidien.</p>

      <button class="add-cart" onclick="addToCart('Baskets REACTIVE', 24.90)">âž• Ajouter au panier</button>

      <div class="buy-button">
        <stripe-buy-button
          buy-button-id="buy_btn_1Rc5XsCOWsHWoBEG2nv9HMNE"
          publishable-key="pk_live_51Rb21ICOWsHWoBEGmAY8BEDjuDe7KjsHoTY4hzhve9aiZd0tUaQoaIEG3aoGHHnwjtc8VrEBDJrIZReI0CTVLYqQ00fikEjr67">
        </stripe-buy-button>
      </div>
    </div>

    <!-- Casque -->
    <div class="product-card" data-name="casque bluetooth p47 sans fil audio musique" data-price="19.99">
      <div class="badge-sale">-25 % SOLDES</div>
      <img src="images/casque.jpeg" alt="Casque Bluetooth P47">
      <h2>Casque Bluetooth P47 Sans Fil</h2>

      <div class="price">
        <span class="old-price">26,65 â‚¬</span>
        <span class="current">19,99 â‚¬</span>
      </div>

      <p class="description">Son clair, Bluetooth 5.0, design pliable, boutons intÃ©grÃ©s. LÃ©ger et pratique.</p>

      <button class="add-cart" onclick="addToCart('Casque Bluetooth P47', 19.99)">âž• Ajouter au panier</button>

      <div class="buy-button">
        <stripe-buy-button
          buy-button-id="buy_btn_1Rc8nOCOWsHWoBEGmQVZnG10"
          publishable-key="pk_live_51Rb21ICOWsHWoBEGmAY8BEDjuDe7KjsHoTY4hzhve9aiZd0tUaQoaIEG3aoGHHnwjtc8VrEBDJrIZReI0CTVLYqQ00fikEjr67">
        </stripe-buy-button>
      </div>
    </div>

    <!-- Humidificateur -->
    <div class="product-card" data-name="humidificateur led zen multicolore maison chambre bureau" data-price="29.99">
      <div class="badge-sale">-25 % SOLDES</div>
      <img src="images/humidificateur.jpeg" alt="Humidificateur Zen">
      <h2>Humidificateur d'air LED multicolore</h2>

      <div class="price">
        <span class="old-price">39,99 â‚¬</span>
        <span class="current">29,99 â‚¬</span>
      </div>

      <p class="description">Hydrate lâ€™air avec lumiÃ¨re apaisante. Parfait pour maison, bureau ou chambre.</p>

      <button class="add-cart" onclick="addToCart('Humidificateur LED', 29.99)">âž• Ajouter au panier</button>

      <div class="buy-button">
        <stripe-buy-button
          buy-button-id="buy_btn_1RcUVBCOWsHWoBEGCNEdp9Ah"
          publishable-key="pk_live_51Rb21ICOWsHWoBEGmAY8BEDjuDe7KjsHoTY4hzhve9aiZd0tUaQoaIEG3aoGHHnwjtc8VrEBDJrIZReI0CTVLYqQ00fikEjr67">
        </stripe-buy-button>
      </div>
    </div>

  </div>

  <div class="empty" id="emptyState">
    Aucun produit ne correspond Ã  ta recherche.
  </div>

  <footer>
    &copy; 2025 â€“ ErazShop â€“ Tous droits rÃ©servÃ©s
  </footer>

  <!-- PANIER -->
  <div id="cart">
    <div id="cart-header">
      <span>ðŸ›’ Panier (<span id="cart-count">0</span>)</span>
      <span id="free-ship-badge" style="font-size:0.85rem; font-weight:700; opacity:0.85;"></span>
    </div>

    <div id="cart-items"></div>

    <div class="cart-line">
      <span>Sous-total</span>
      <span id="subtotal">0,00 â‚¬</span>
    </div>

    <div class="cart-line">
      <span>Livraison</span>
      <span id="shipping">0,00 â‚¬</span>
    </div>

    <div class="cart-total">
      <strong>Total</strong>
      <strong id="total">0,00 â‚¬</strong>
    </div>

    <div class="cart-note" id="shipping-note">
      Livraison : 5 â‚¬ (gratuite dÃ¨s 100 â‚¬)
    </div>

    <div class="cart-actions">
      <button onclick="clearCart()">Vider</button>
      <button class="primary" onclick="checkoutInfo()">Commander</button>
    </div>
  </div>

  <!-- Stripe chargÃ© UNE seule fois -->
  <script async src="https://js.stripe.com/v3/buy-button.js"></script>

  <script>
    /* =========================
       RECHERCHE
       ========================= */
    const input = document.getElementById('searchInput');
    const cards = Array.from(document.querySelectorAll('.product-card'));
    const emptyState = document.getElementById('emptyState');
    const countHint = document.getElementById('countHint');

    function normalizeText(str) {
      return (str || "")
        .toLowerCase()
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "");
    }

    function updateList() {
      const q = normalizeText(input.value.trim());
      let visibleCount = 0;

      cards.forEach(card => {
        const name = normalizeText(card.getAttribute('data-name'));
        const title = normalizeText(card.querySelector('h2')?.textContent);
        const desc  = normalizeText(card.querySelector('.description')?.textContent);
        const haystack = `${name} ${title} ${desc}`;

        const match = q === "" || haystack.includes(q);
        card.style.display = match ? "" : "none";
        if (match) visibleCount++;
      });

      emptyState.style.display = visibleCount === 0 ? "block" : "none";
      countHint.textContent = q
        ? `${visibleCount} produit(s) trouvÃ©(s)`
        : `${cards.length} produit(s) disponible(s)`;
    }

    input.addEventListener('input', updateList);
    updateList();

    /* =========================
       PANIER + LIVRAISON
       - Livraison : 5 â‚¬
       - Gratuite dÃ¨s 100 â‚¬
       ========================= */
    let cart = [];

    const cartItemsEl = document.getElementById("cart-items");
    const cartCountEl = document.getElementById("cart-count");
    const subtotalEl  = document.getElementById("subtotal");
    const shippingEl  = document.getElementById("shipping");
    const totalEl     = document.getElementById("total");
    const freeShipBadge = document.getElementById("free-ship-badge");
    const shippingNote = document.getElementById("shipping-note");

    function formatEUR(n) {
      return n.toFixed(2).replace('.', ',') + " â‚¬";
    }

    function addToCart(name, price) {
      cart.push({ name, price });
      updateCart();
    }

    function removeFromCart(index) {
      cart.splice(index, 1);
      updateCart();
    }

    function clearCart() {
      cart = [];
      updateCart();
    }

    function calcShipping(subtotal) {
      if (cart.length === 0) return 0;       // pas de panier => pas de livraison
      if (subtotal >= 100) return 0;         // gratuite dÃ¨s 100 â‚¬
      return 5;                              // sinon 5 â‚¬
    }

    function updateCart() {
      cartItemsEl.innerHTML = "";

      let subtotal = 0;
      cart.forEach((item, index) => {
        subtotal += item.price;

        const row = document.createElement("div");
        row.className = "cart-item";
        row.innerHTML = `
          <div class="name">${item.name}</div>
          <div class="right">
            <span>${formatEUR(item.price).replace(',00', '')}</span>
            <button aria-label="Supprimer" title="Supprimer" onclick="removeFromCart(${index})">âœ•</button>
          </div>
        `;
        cartItemsEl.appendChild(row);
      });

      const shipping = calcShipping(subtotal);
      const total = subtotal + shipping;

      cartCountEl.textContent = cart.length;
      subtotalEl.textContent  = formatEUR(subtotal);
      shippingEl.textContent  = (shipping === 0 && cart.length > 0 && subtotal >= 100)
        ? "Gratuite ðŸŽ‰"
        : formatEUR(shipping);

      totalEl.textContent = formatEUR(total);

      if (cart.length === 0) {
        freeShipBadge.textContent = "";
        shippingNote.textContent = "Ajoute des produits pour calculer la livraison.";
      } else if (subtotal >= 100) {
        freeShipBadge.textContent = "ðŸšš Livraison offerte !";
        shippingNote.textContent = "Bravo ðŸŽ‰ Livraison gratuite dÃ¨s 100 â‚¬.";
      } else {
        const reste = 100 - subtotal;
        freeShipBadge.textContent = "";
        shippingNote.textContent = `Plus que ${formatEUR(reste)} pour la livraison gratuite.`;
      }
    }

    function checkoutInfo() {
      if (cart.length === 0) {
        alert("Ton panier est vide ðŸ™‚");
        return;
      }
      alert("Panier ajoutÃ© âœ…\n\nIci, on peut connecter un vrai bouton 'Commander' vers Stripe Checkout si tu veux.");
    }

    updateCart();
  </script>

</body>
</html>